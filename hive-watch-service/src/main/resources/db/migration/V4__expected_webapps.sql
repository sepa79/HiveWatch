create table if not exists hw_tomcat_expected_webapps (
  id uuid primary key,
  server_id uuid not null references hw_servers(id) on delete cascade,
  role text not null,
  path text not null,
  created_at timestamptz not null default now(),

  constraint hw_tomcat_expected_webapps_path_not_empty check (length(trim(path)) > 0),
  constraint hw_tomcat_expected_webapps_path_format check (left(path, 1) = '/'),
  constraint hw_tomcat_expected_webapps_unique unique (server_id, role, path)
);

create index if not exists hw_tomcat_expected_webapps_server_id_idx on hw_tomcat_expected_webapps(server_id);

-- Dev seed: expected webapps per Server + Role (matches dummy-stack)
insert into hw_tomcat_expected_webapps(id, server_id, role, path)
values
  -- NFT-01 / Touchpoint
  ('11111111-1111-1111-1111-11111111a101', '11111111-1111-1111-1111-111111110001', 'PAYMENTS', '/PaymentApp1'),
  ('11111111-1111-1111-1111-11111111a102', '11111111-1111-1111-1111-111111110001', 'PAYMENTS', '/PaymentApp2'),
  ('11111111-1111-1111-1111-11111111a103', '11111111-1111-1111-1111-111111110001', 'PAYMENTS', '/SharedPaymentsApp'),
  ('11111111-1111-1111-1111-11111111a111', '11111111-1111-1111-1111-111111110001', 'SERVICES', '/ServicesApp1'),
  ('11111111-1111-1111-1111-11111111a112', '11111111-1111-1111-1111-111111110001', 'SERVICES', '/TouchpointGateway'),
  ('11111111-1111-1111-1111-11111111a113', '11111111-1111-1111-1111-111111110001', 'SERVICES', '/SharedServicesApp'),
  ('11111111-1111-1111-1111-11111111a121', '11111111-1111-1111-1111-111111110001', 'AUTH', '/AuthApp1'),
  ('11111111-1111-1111-1111-11111111a122', '11111111-1111-1111-1111-111111110001', 'AUTH', '/SSOConsole'),
  ('11111111-1111-1111-1111-11111111a123', '11111111-1111-1111-1111-111111110001', 'AUTH', '/SharedAuthApp'),

  -- NFT-01 / Services
  ('11111111-1111-1111-1111-11111111b101', '11111111-1111-1111-1111-111111110002', 'PAYMENTS', '/PaymentApp2'),
  ('11111111-1111-1111-1111-11111111b102', '11111111-1111-1111-1111-111111110002', 'PAYMENTS', '/PaymentApp3'),
  ('11111111-1111-1111-1111-11111111b103', '11111111-1111-1111-1111-111111110002', 'PAYMENTS', '/SharedPaymentsApp'),
  ('11111111-1111-1111-1111-11111111b111', '11111111-1111-1111-1111-111111110002', 'SERVICES', '/ServicesApp1'),
  ('11111111-1111-1111-1111-11111111b112', '11111111-1111-1111-1111-111111110002', 'SERVICES', '/ServicesApp2'),
  ('11111111-1111-1111-1111-11111111b113', '11111111-1111-1111-1111-111111110002', 'SERVICES', '/SharedServicesApp'),
  ('11111111-1111-1111-1111-11111111b121', '11111111-1111-1111-1111-111111110002', 'AUTH', '/AuthApp1'),
  ('11111111-1111-1111-1111-11111111b122', '11111111-1111-1111-1111-111111110002', 'AUTH', '/AuthApp2'),
  ('11111111-1111-1111-1111-11111111b123', '11111111-1111-1111-1111-111111110002', 'AUTH', '/SharedAuthApp'),

  -- NFT-02 / All-in-one
  ('22222222-2222-2222-2222-22222222a101', '22222222-2222-2222-2222-222222220001', 'PAYMENTS', '/PaymentApp1'),
  ('22222222-2222-2222-2222-22222222a102', '22222222-2222-2222-2222-222222220001', 'PAYMENTS', '/PaymentApp2'),
  ('22222222-2222-2222-2222-22222222a103', '22222222-2222-2222-2222-222222220001', 'PAYMENTS', '/PaymentApp3'),
  ('22222222-2222-2222-2222-22222222a104', '22222222-2222-2222-2222-222222220001', 'PAYMENTS', '/SharedPaymentsApp'),
  ('22222222-2222-2222-2222-22222222a111', '22222222-2222-2222-2222-222222220001', 'SERVICES', '/ServicesApp1'),
  ('22222222-2222-2222-2222-22222222a112', '22222222-2222-2222-2222-222222220001', 'SERVICES', '/ServicesApp2'),
  ('22222222-2222-2222-2222-22222222a113', '22222222-2222-2222-2222-222222220001', 'SERVICES', '/TouchpointGateway'),
  ('22222222-2222-2222-2222-22222222a114', '22222222-2222-2222-2222-222222220001', 'SERVICES', '/SharedServicesApp'),
  ('22222222-2222-2222-2222-22222222a121', '22222222-2222-2222-2222-222222220001', 'AUTH', '/AuthApp1'),
  ('22222222-2222-2222-2222-22222222a122', '22222222-2222-2222-2222-222222220001', 'AUTH', '/AuthApp2'),
  ('22222222-2222-2222-2222-22222222a123', '22222222-2222-2222-2222-222222220001', 'AUTH', '/SSOConsole'),
  ('22222222-2222-2222-2222-22222222a124', '22222222-2222-2222-2222-222222220001', 'AUTH', '/SharedAuthApp'),

  -- Release-01 / All-in-one
  ('33333333-3333-3333-3333-33333333a101', '33333333-3333-3333-3333-333333330001', 'PAYMENTS', '/PaymentApp1'),
  ('33333333-3333-3333-3333-33333333a102', '33333333-3333-3333-3333-333333330001', 'PAYMENTS', '/PaymentApp2'),
  ('33333333-3333-3333-3333-33333333a103', '33333333-3333-3333-3333-333333330001', 'PAYMENTS', '/PaymentApp3'),
  ('33333333-3333-3333-3333-33333333a104', '33333333-3333-3333-3333-333333330001', 'PAYMENTS', '/SharedPaymentsApp'),
  ('33333333-3333-3333-3333-33333333a111', '33333333-3333-3333-3333-333333330001', 'SERVICES', '/ServicesApp1'),
  ('33333333-3333-3333-3333-33333333a112', '33333333-3333-3333-3333-333333330001', 'SERVICES', '/ServicesApp2'),
  ('33333333-3333-3333-3333-33333333a113', '33333333-3333-3333-3333-333333330001', 'SERVICES', '/TouchpointGateway'),
  ('33333333-3333-3333-3333-33333333a114', '33333333-3333-3333-3333-333333330001', 'SERVICES', '/SharedServicesApp'),
  ('33333333-3333-3333-3333-33333333a121', '33333333-3333-3333-3333-333333330001', 'AUTH', '/AuthApp1'),
  ('33333333-3333-3333-3333-33333333a122', '33333333-3333-3333-3333-333333330001', 'AUTH', '/AuthApp2'),
  ('33333333-3333-3333-3333-33333333a123', '33333333-3333-3333-3333-333333330001', 'AUTH', '/SSOConsole'),
  ('33333333-3333-3333-3333-33333333a124', '33333333-3333-3333-3333-333333330001', 'AUTH', '/SharedAuthApp')
on conflict (id) do nothing;

